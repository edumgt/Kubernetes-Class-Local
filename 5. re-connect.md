## Re Boot and Re Connect

https://192.168.56.10:8443/ 으로 안보임

안 보이는 게 정상일 수 있는 포인트가 딱 2개입니다:

지금 cp1에서 8443을 “kubectl port-forward(0.0.0.0)”가 잡고 있지 않음

8443을 ssh 터널(-L)이 127.0.0.1에만 잡고 있어서(외부에서 접근 불가)

지금 당신 로그에선 8443을 ssh(pid=7016)가 127.0.0.1:8443로 잡고 있는 상태였죠.
그 상태에선 https://192.168.56.10:8443 로는 절대 안 보입니다. (로컬 루프백만 열려있음)

아래 순서대로 “외부(호스트)에서 보이게” 정리해봅시다.

1) cp1에서 8443 점유중인 ssh 포워딩 끄기

cp1에서(이미 pid=7016 확인했으니):

sudo kill 7016


확인:

sudo ss -lntp | grep ':8443' || echo "no listener on 8443"


여기서 no listener가 떠야 정상입니다.

2) cp1에서 “외부 접근 가능”하게 port-forward 다시 띄우기

cp1에서 아래 명령을 실행하고 그 터미널은 켜 둔 채로 두세요(끊으면 포워딩도 종료됨):

kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard-kong-proxy 8443:443 --address 0.0.0.0


이제 리스닝 확인:

sudo ss -lntp | grep ':8443'


정상이라면 이런 식으로 보여야 해요(ssh가 아니라 kubectl이 떠야 함):

![alt text](image-6.png)

LISTEN ... 0.0.0.0:8443 ... users:(("kubectl",pid=...))

3) Windows에서 포트 열렸는지 먼저 테스트 (브라우저 전에)

PowerShell:

Test-NetConnection 192.168.56.10 -Port 8443
![alt text](image-7.png)


TcpTestSucceeded : True 면 네트워크 OK → 브라우저 문제(인증서 경고)일 확률 큼

False 면 cp1에서 리스닝/방화벽 문제

4) 브라우저에서 접속할 때 “인증서 경고”를 넘어가야 합니다

Chrome/Edge에서 https://192.168.56.10:8443 접속하면

![alt text](image-8.png)

“안전하지 않음/개인정보 보호 오류” 화면이 뜰 수 있어요.

그때 고급(Advanced) → (안전하지 않음)으로 이동을 눌러야 화면이 열립니다.

5) 혹시 UFW가 켜져 있으면 8443 허용

cp1에서:

sudo ufw status


Status: active면:

sudo ufw allow 8443/tcp

제일 빠른 체크 2개만 답 주세요

cp1에서 sudo ss -lntp | grep ':8443' 출력(ssh인지 kubectl인지 확인)

Windows에서 Test-NetConnection 192.168.56.10 -Port 8443 결과

이 두 개만 보면 “왜 안 보이는지”를 100%로 딱 찍어서 다음 단계(토큰 생성/로그인)까지 바로 이어갈게요.

ubuntu@cp1:~$ sudo kill 7016
[sudo] password for ubuntu:
kill: (7016): No such process
ubuntu@cp1:~$ sudo ss -lntp | grep ':8443' || echo "no listener on 8443"
LISTEN 0      4096       127.0.0.1:8443       0.0.0.0:*    users:(("kubectl",pid=9537,fd=8))
LISTEN 0      4096           [::1]:8443          [::]:*    users:(("kubectl",pid=9537,fd=9))
ubuntu@cp1:~$

좋아요, 지금 상태가 딱 보입니다. ✅

8443은 kubectl(pid=9537) 이 잡고 있지만,

127.0.0.1 / ::1 (로컬 루프백)에만 바인딩되어 있어요.

그래서 Windows에서 https://192.168.56.10:8443로는 절대 접속이 안 됩니다.
외부(호스트)에서 보이게 하려면 --address 0.0.0.0로 다시 띄워야 합니다.

1) 먼저 현재 port-forward 프로세스 종료
sudo kill 9537


확인:

sudo ss -lntp | grep ':8443' || echo "no listener on 8443"


여기서 no listener on 8443가 떠야 합니다.

2) 외부에서 접근 가능하게 다시 실행 (중요)
kubectl -n kubernetes-dashboard port-forward svc/kubernetes-dashboard-kong-proxy 8443:443 --address 0.0.0.0


다시 리슨 확인:

sudo ss -lntp | grep ':8443'


이번엔 이렇게 떠야 정상입니다:

0.0.0.0:8443 (또는 192.168.56.10:8443) 에서 LISTEN

users가 kubectl

3) Windows에서 포트 테스트 후 브라우저 접속

PowerShell:

Test-NetConnection 192.168.56.10 -Port 8443


TcpTestSucceeded : True 나오면 브라우저에서:

https://192.168.56.10:8443

⚠️ 인증서 경고 뜨면 고급 → 계속으로 들어가야 합니다.

참고(왜 이런 일이 생겼나)

kubectl port-forward는 기본이 localhost(127.0.0.1) 바인딩이라서, --address 0.0.0.0을 안 주면 외부에서 못 봅니다.
---
## token 다시
kubectl -n kubernetes-dashboard create token admin-user

![alt text](image-9.png)

![alt text](image-10.png)

---
ubuntu@cp1:~$ kubectl -n kubernetes-dashboard get pods,svc
NAME                                                        READY   STATUS    RESTARTS   AGE
pod/kubernetes-dashboard-api-6d5bb95b6c-nzjvg               1/1     Running   0          5d22h
pod/kubernetes-dashboard-auth-6f886b65cf-bp4hc              1/1     Running   0          5d22h
pod/kubernetes-dashboard-kong-9849c64bd-hrcx2               1/1     Running   0          5d22h
pod/kubernetes-dashboard-metrics-scraper-7685fd8b77-95wkp   1/1     Running   0          5d22h
pod/kubernetes-dashboard-web-5c9f966b98-gd5c6               1/1     Running   0          5d22h

NAME                                           TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE
service/kubernetes-dashboard-api               ClusterIP   10.43.110.114   <none>        8000/TCP   5d22h
service/kubernetes-dashboard-auth              ClusterIP   10.43.70.251    <none>        8000/TCP   5d22h
service/kubernetes-dashboard-kong-proxy        ClusterIP   10.43.21.190    <none>        443/TCP    5d22h
service/kubernetes-dashboard-metrics-scraper   ClusterIP   10.43.170.27    <none>        8000/TCP   5d22h
service/kubernetes-dashboard-web               ClusterIP   10.43.122.190   <none>        8000/TCP   5d22h
ubuntu@cp1:~$