# SSH 빠른 접속 메모 (UTM Ubuntu 서버 VM)

> 목표: Ubuntu 서버 VM(cp1 등)에 **SSH로 접속**해 macOS 터미널에서 복붙하며 운영합니다.

---

## 1) cp1에서 SSH 서버 설치/활성화

```bash
sudo apt update
sudo apt install -y openssh-server
sudo systemctl enable --now ssh
sudo systemctl status ssh --no-pager -l
```

정상 예시:

```text
Active: active (running)
```

---

## 2) UFW가 켜져 있으면 22/tcp 허용 (선택)

```bash
sudo ufw status
```

`Status: active`라면:

```bash
sudo ufw allow 22/tcp
```

---

## 3) 22번 포트 리스닝 확인

```bash
sudo ss -lntp | grep ':22' || echo "22 not listening"
```

---

## 4) macOS에서 접속

Terminal:

```bash
ssh ubuntu@192.168.64.10
```

- Shared Network IP가 아직 확정 전이면 현재 VM IP(예: `192.168.64.101`)로 접속합니다.
- 첫 접속 시 fingerprint 확인은 `yes` 입력.

---

## 5) 자주 발생하는 문제 요약

### 5-1) `Connection refused`

대부분 **sshd가 실행되지 않은 상태**입니다. 섹션 1~3을 재확인하세요.

### 5-2) `no hostkeys available`

```bash
sudo ssh-keygen -A
sudo systemctl restart ssh
sudo systemctl status ssh --no-pager -l
```

---

## 6) Desktop VM인 경우 (UTM 게스트 도구)

GUI가 있는 VM이라면:

- 게스트에서 클립보드/드래그앤드롭을 쓰려면 `spice-vdagent` 설치
  - `sudo apt install -y spice-vdagent`

서버(Text) VM에서는 SSH가 가장 효율적입니다.
